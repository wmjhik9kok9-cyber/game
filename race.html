<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¢ãƒ‹ãƒãƒ«ãƒ»ãƒ€ãƒ¼ãƒ“ãƒ¼</title>
    <style>
        body { font-family: sans-serif; background: #27ae60; color: white; text-align: center; margin: 0; padding: 10px; }
        
        .track-field { 
            background: #2ecc71; width: 95%; max-width: 600px; 
            margin: 20px auto; padding: 10px; border: 5px solid #fff; 
            border-radius: 10px; position: relative; overflow: hidden;
        }
        .lane { height: 50px; border-bottom: 1px dashed rgba(255,255,255,0.4); position: relative; display: flex; align-items: center; }
        .animal { position: absolute; left: 0; font-size: 32px; transition: left 0.05s linear; z-index: 2; } /* å‹•ãã‚’ã‚ˆã‚Šç´°ã‹ã */
        
        .goal-line { position: absolute; right: 60px; top: 0; bottom: 0; width: 6px; background: #e74c3c; z-index: 1; }
        
        .controls { background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; display: inline-block; margin-bottom: 10px; }
        #status-area { font-size: 20px; font-weight: bold; background: #f39c12; color: #2c3e50; padding: 10px; border-radius: 10px; display: none; margin-bottom: 10px; }
        
        select { font-size: 18px; padding: 8px; border-radius: 5px; }
        button { font-size: 18px; padding: 10px 20px; background: #e67e22; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        #result-msg { font-size: 22px; margin-top: 15px; min-height: 100px; line-height: 1.4; }
    </style>
</head>
<body>

    <h1>ğŸ ã‚¢ãƒ‹ãƒãƒ«ãƒ»ãƒ€ãƒ¼ãƒ“ãƒ¼ ğŸ</h1>

    <div id="status-area">ã‚ãªãŸã®äºˆæƒ³ï¼š<span id="my-pick"></span></div>

    <div class="controls" id="ui">
        <p>1ç€ã‚’äºˆæƒ³ã—ã¦ã­ï¼</p>
        <select id="prediction"></select><br>
        <button onclick="startRace()">ãƒ¬ãƒ¼ã‚¹é–‹å§‹ï¼</button>
    </div>

    <div class="track-field" id="track">
        <div class="goal-line"></div>
    </div>

    <div id="result-msg"></div>

<script>
    const animals = ["ğŸ±", "ğŸ°", "ğŸ¹", "ğŸ¦", "ğŸ¼", "ğŸ¨", "ğŸ¯", "ğŸ¦“", "ğŸ¦„", "ğŸµ"];
    const track = document.getElementById("track");
    const select = document.getElementById("prediction");
    
    // ã‚´ãƒ¼ãƒ«ãƒ©ã‚¤ãƒ³ã®ä½ç½®ï¼ˆ%ï¼‰
    const goalLinePercent = 85; 

    // åˆæœŸè¨­å®š
    animals.forEach((emoji, i) => {
        let opt = document.createElement("option");
        opt.value = i;
        opt.innerText = `${i + 1}ç•ªï¼š${emoji}`;
        select.appendChild(opt);

        let lane = document.createElement("div");
        lane.className = "lane";
        lane.innerHTML = `<span class="animal" id="animal-${i}" style="left: 0%">${emoji}</span>`;
        track.appendChild(lane);
    });

    function startRace() {
        const pickIdx = select.value;
        document.getElementById("my-pick").innerText = animals[pickIdx];
        document.getElementById("status-area").style.display = "inline-block";
        document.getElementById("ui").style.display = "none";
        document.getElementById("result-msg").innerHTML = ""; // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚»ãƒƒãƒˆ
        
        const racers = animals.map((_, i) => ({ id: `animal-${i}`, pos: 0 }));
        let isRaceOver = false;

        // 0.05ç§’ã”ã¨ã«ä½ç½®ã‚’æ›´æ–°
        const interval = setInterval(() => {
            racers.forEach((racer, index) => {
                // ã™ã§ã«èª°ã‹ãŒã‚´ãƒ¼ãƒ«ã—ã¦ã„ãŸã‚‰ã€ã‚‚ã†èª°ã‚‚å‹•ã‹ã•ãªã„ï¼ˆå®Œå…¨åœæ­¢ï¼‰
                if (isRaceOver) return;

                // ãƒ©ãƒ³ãƒ€ãƒ ã«å‰é€²
                racer.pos += Math.random() * 0.8;
                document.getElementById(racer.id).style.left = racer.pos + "%";

                // ã€ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆã€‘èª°ã‹ãŒãƒ©ã‚¤ãƒ³ã‚’è¶…ãˆãŸã‚‰...
                if (racer.pos >= goalLinePercent) {
                    isRaceOver = true;         // ãƒ¬ãƒ¼ã‚¹çµ‚äº†ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹
                    clearInterval(interval);   // ã‚¿ã‚¤ãƒãƒ¼ã‚’å¼·åˆ¶åœæ­¢ï¼ˆå…¨å“¡æ­¢ã¾ã‚‹ï¼‰
                    showResult(index);         // çµæœç™ºè¡¨
                }
            });
        }, 50);
    }

    function showResult(winIdx) {
        const prediction = document.getElementById("prediction").value;
        const msg = document.getElementById("result-msg");
        const winEmoji = animals[winIdx];

        if (parseInt(prediction) === winIdx) {
            msg.innerHTML = `çµæœï¼š<span style="font-size:40px">${winEmoji}</span> ãŒ1ç€ï¼<br><span style="color:#f1c40f; font-weight:bold;">çš„ä¸­ï¼ãŠã‚ã§ã¨ã†ï¼ğŸ‰</span>`;
        } else {
            msg.innerHTML = `çµæœï¼š<span style="font-size:40px">${winEmoji}</span> ãŒ1ç€ï¼<br>æ®‹å¿µã€ãƒã‚ºãƒ¬ã§ã™...`;
        }

        const reBtn = document.createElement("button");
        reBtn.innerText = "ã‚‚ã†ä¸€åº¦éŠã¶";
        reBtn.onclick = () => location.reload();
        reBtn.style.display = "block";
        reBtn.style.margin = "15px auto";
        msg.appendChild(reBtn);
    }
</script>
</body>
</html>